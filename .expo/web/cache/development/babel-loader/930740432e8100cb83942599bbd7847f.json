{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _defineProperty from \"@babel/runtime/helpers/defineProperty\";\nimport _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nvar _jsxFileName = \"/home/bayons/indicom-app-master/app/pages/MeuPerfil/MeuPerfil.jsx\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport React, { useContext, useState, useEffect } from 'react';\nimport View from \"react-native-web/dist/exports/View\";\nimport Text from \"react-native-web/dist/exports/Text\";\nimport StyleSheet from \"react-native-web/dist/exports/StyleSheet\";\nimport Image from \"react-native-web/dist/exports/Image\";\nimport ScrollView from \"react-native-web/dist/exports/ScrollView\";\nimport Alert from \"react-native-web/dist/exports/Alert\";\nimport Platform from \"react-native-web/dist/exports/Platform\";\nimport TouchableWithoutFeedback from \"react-native-web/dist/exports/TouchableWithoutFeedback\";\nimport { useNavigation } from '@react-navigation/native';\nimport * as ImagePicker from 'expo-image-picker';\nimport * as Permissions from 'expo-permissions';\nimport AuthContext from \"../../contexts/auth\";\nimport Api from \"../../services/Api\";\nimport Footer from \"../../components/template/Footer\";\nimport InfoContainer from \"./components/InfoContainer\";\nimport RateStars from \"../../components/RateStars\";\nimport ComentariosContainer from \"../../components/ComentariosContainer/ComentariosContainer\";\nimport NoUser from \"../../../assets/img/user-icon.png\";\nimport Styles from \"./styles\";\nvar styles = StyleSheet.create(Styles);\n\nvar MeuPerfil = function MeuPerfil() {\n  var _useContext = useContext(AuthContext),\n      user = _useContext.user,\n      setLoading = _useContext.setLoading,\n      setUser = _useContext.setUser;\n\n  var _useState = useState({}),\n      _useState2 = _slicedToArray(_useState, 2),\n      currentUser = _useState2[0],\n      setCurrentUser = _useState2[1];\n\n  var _useState3 = useState([]),\n      _useState4 = _slicedToArray(_useState3, 2),\n      AtividadesLista = _useState4[0],\n      setAtividadesLista = _useState4[1];\n\n  var navigation = useNavigation();\n  var infoItems = [{\n    label: 'Nome',\n    value: currentUser.name\n  }, {\n    label: 'E-mail',\n    value: currentUser.email\n  }, {\n    label: 'Atividade',\n    value: currentUser.ActivityBranch && currentUser.ActivityBranch.name || currentUser.EconomicActivity && currentUser.EconomicActivity.name || ''\n  }, {\n    label: 'Empresa',\n    value: currentUser.companyName\n  }, {\n    label: 'Whats',\n    value: currentUser.whatsapp\n  }, {\n    label: 'Website',\n    value: currentUser.website\n  }, {\n    label: 'Facebook',\n    value: currentUser.facebook\n  }];\n  var atividadesItems = AtividadesLista.map(function (atividade) {\n    var response = {\n      label: atividade.label,\n      value: []\n    };\n    var atividadesList = currentUser.activities.map(function (i) {\n      return i.id;\n    });\n    atividade.data.map(function (categoria) {\n      if (atividadesList.includes(categoria.id)) {\n        response.value.push(categoria.label);\n      }\n\n      return categoria;\n    });\n    return response.value.length > 0 ? _objectSpread(_objectSpread({}, response), {}, {\n      value: response.value.join(', ')\n    }) : {};\n  }).filter(function (atividade) {\n    return atividade.label;\n  });\n\n  var createImage = function createImage() {\n    var result, _await$Api$post, status, data;\n\n    return _regeneratorRuntime.async(function createImage$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            _context.prev = 0;\n            _context.next = 3;\n            return _regeneratorRuntime.awrap(ImagePicker.launchImageLibraryAsync({\n              mediaTypes: ImagePicker.MediaTypeOptions.All,\n              allowsEditing: true,\n              aspect: [3, 3],\n              quality: 1,\n              base64: true\n            }));\n\n          case 3:\n            result = _context.sent;\n\n            if (result.cancelled) {\n              _context.next = 14;\n              break;\n            }\n\n            setLoading(true);\n            _context.next = 8;\n            return _regeneratorRuntime.awrap(Api.post(\"/v1/users/\" + user.id + \"/image\", {\n              image: result\n            }));\n\n          case 8:\n            _await$Api$post = _context.sent;\n            status = _await$Api$post.status;\n            data = _await$Api$post.data;\n            setLoading(false);\n\n            if (status !== 200) {\n              Alert.alert('Error', 'Something goes wrong in server');\n            }\n\n            setUser(_objectSpread(_objectSpread({}, user), {}, {\n              Image: {\n                imageUrl: data.url\n              }\n            }));\n\n          case 14:\n            _context.next = 19;\n            break;\n\n          case 16:\n            _context.prev = 16;\n            _context.t0 = _context[\"catch\"](0);\n            console.log(_context.t0);\n\n          case 19:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, null, null, [[0, 16]], Promise);\n  };\n\n  useEffect(function () {\n    (function _callee() {\n      var _await$Permissions$as, status;\n\n      return _regeneratorRuntime.async(function _callee$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              if (!(Platform.OS !== 'web')) {\n                _context2.next = 6;\n                break;\n              }\n\n              _context2.next = 3;\n              return _regeneratorRuntime.awrap(Permissions.askAsync(Permissions.CAMERA_ROLL));\n\n            case 3:\n              _await$Permissions$as = _context2.sent;\n              status = _await$Permissions$as.status;\n\n              if (status !== 'granted') {\n                Alert.alert('Error', 'Sorry, we need camera roll permissions to make this work!');\n              }\n\n            case 6:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, null, null, null, Promise);\n    })();\n  }, []);\n  useEffect(function () {\n    var fetchApiData = function fetchApiData() {\n      var userData, response, activities;\n      return _regeneratorRuntime.async(function fetchApiData$(_context3) {\n        while (1) {\n          switch (_context3.prev = _context3.next) {\n            case 0:\n              setLoading(true);\n              _context3.next = 3;\n              return _regeneratorRuntime.awrap(Api.get(\"v1/users/\" + user.id));\n\n            case 3:\n              userData = _context3.sent;\n\n              if (!(userData.status !== 200)) {\n                _context3.next = 8;\n                break;\n              }\n\n              Alert.alert('Erro', 'Houve um erro no servidor, tente novamente mais tarde');\n              _context3.next = 13;\n              break;\n\n            case 8:\n              setCurrentUser(userData.data);\n              _context3.next = 11;\n              return _regeneratorRuntime.awrap(Api.get('v1/activities'));\n\n            case 11:\n              response = _context3.sent;\n\n              if (response.status !== 200) {\n                Alert.alert('Erro', 'Houve um erro no servidor, tente novamente mais tarde');\n              } else {\n                setLoading(false);\n                activities = response.data.map(function (activity) {\n                  var nest = activity.nest.map(function (subActivity) {\n                    return {\n                      id: subActivity.id,\n                      label: subActivity.name,\n                      checked: false\n                    };\n                  });\n                  return {\n                    id: activity.id,\n                    label: activity.name,\n                    open: false,\n                    data: nest\n                  };\n                });\n                setAtividadesLista(activities);\n              }\n\n            case 13:\n            case \"end\":\n              return _context3.stop();\n          }\n        }\n      }, null, null, null, Promise);\n    };\n\n    fetchApiData();\n  }, [user]);\n  return React.createElement(View, {\n    style: styles.wrapper,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 165,\n      columnNumber: 5\n    }\n  }, React.createElement(ScrollView, {\n    style: {\n      width: '100%',\n      marginTop: 30\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 166,\n      columnNumber: 7\n    }\n  }, React.createElement(View, {\n    style: styles.body,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 167,\n      columnNumber: 9\n    }\n  }, React.createElement(TouchableWithoutFeedback, {\n    onPress: function onPress() {\n      return createImage();\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 168,\n      columnNumber: 11\n    }\n  }, React.createElement(Image, {\n    source: user.Image !== null ? {\n      uri: user.Image.imageUrl\n    } : NoUser,\n    style: styles.logoImage,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 169,\n      columnNumber: 13\n    }\n  })), React.createElement(Text, {\n    style: styles.userName,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 176,\n      columnNumber: 11\n    }\n  }, currentUser.name, ' ', React.createElement(Text, {\n    style: styles.rate,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 178,\n      columnNumber: 13\n    }\n  }, currentUser.rate)), React.createElement(RateStars, {\n    nota: currentUser.rate,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 180,\n      columnNumber: 11\n    }\n  }), React.createElement(InfoContainer, {\n    title: \"Informa\\xE7\\xF5es\",\n    items: infoItems,\n    setCurrentUser: setCurrentUser,\n    onPress: function onPress() {\n      return navigation.navigate('InformacoesGerais');\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 181,\n      columnNumber: 11\n    }\n  }), React.createElement(InfoContainer, {\n    title: \"Ramo de Atividade\",\n    items: atividadesItems,\n    onPress: function onPress() {\n      return navigation.navigate('MinhasAtividades');\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 187,\n      columnNumber: 11\n    }\n  }), React.createElement(ComentariosContainer, {\n    user: user,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 192,\n      columnNumber: 11\n    }\n  }))), React.createElement(Footer, {\n    active: \"Meu Perfil\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 195,\n      columnNumber: 7\n    }\n  }));\n};\n\nexport default MeuPerfil;","map":{"version":3,"sources":["/home/bayons/indicom-app-master/app/pages/MeuPerfil/MeuPerfil.jsx"],"names":["React","useContext","useState","useEffect","useNavigation","ImagePicker","Permissions","AuthContext","Api","Footer","InfoContainer","RateStars","ComentariosContainer","NoUser","Styles","styles","StyleSheet","create","MeuPerfil","user","setLoading","setUser","currentUser","setCurrentUser","AtividadesLista","setAtividadesLista","navigation","infoItems","label","value","name","email","ActivityBranch","EconomicActivity","companyName","whatsapp","website","facebook","atividadesItems","map","atividade","response","atividadesList","activities","i","id","data","categoria","includes","push","length","join","filter","createImage","launchImageLibraryAsync","mediaTypes","MediaTypeOptions","All","allowsEditing","aspect","quality","base64","result","cancelled","post","image","status","Alert","alert","Image","imageUrl","url","console","log","Platform","OS","askAsync","CAMERA_ROLL","fetchApiData","get","userData","activity","nest","subActivity","checked","open","wrapper","width","marginTop","body","uri","logoImage","userName","rate","navigate"],"mappings":"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","sourcesContent":["import React, { useContext, useState, useEffect } from 'react';\nimport {\n  View,\n  Text,\n  StyleSheet,\n  Image,\n  ScrollView,\n  Alert,\n  Platform,\n  TouchableWithoutFeedback,\n} from 'react-native';\nimport { useNavigation } from '@react-navigation/native';\nimport * as ImagePicker from 'expo-image-picker';\nimport * as Permissions from 'expo-permissions';\nimport AuthContext from '../../contexts/auth';\nimport Api from '../../services/Api';\n\nimport Footer from '../../components/template/Footer';\nimport InfoContainer from './components/InfoContainer';\nimport RateStars from '../../components/RateStars';\n\nimport ComentariosContainer from '../../components/ComentariosContainer/ComentariosContainer';\n\nimport NoUser from '../../../assets/img/user-icon.png';\nimport Styles from './styles';\n\nconst styles = StyleSheet.create(Styles);\n\nconst MeuPerfil = () => {\n  const { user, setLoading, setUser } = useContext(AuthContext);\n  const [currentUser, setCurrentUser] = useState({});\n  const [AtividadesLista, setAtividadesLista] = useState([]);\n  const navigation = useNavigation();\n\n  const infoItems = [\n    {\n      label: 'Nome',\n      value: currentUser.name,\n    },\n    {\n      label: 'E-mail',\n      value: currentUser.email,\n    },\n    {\n      label: 'Atividade',\n      value:\n        (currentUser.ActivityBranch && currentUser.ActivityBranch.name) ||\n        (currentUser.EconomicActivity && currentUser.EconomicActivity.name) ||\n        '',\n    },\n    {\n      label: 'Empresa',\n      value: currentUser.companyName,\n    },\n    {\n      label: 'Whats',\n      value: currentUser.whatsapp,\n    },\n    {\n      label: 'Website',\n      value: currentUser.website,\n    },\n    {\n      label: 'Facebook',\n      value: currentUser.facebook,\n    },\n  ];\n\n  const atividadesItems = AtividadesLista.map((atividade) => {\n    const response = { label: atividade.label, value: [] };\n    const atividadesList = currentUser.activities.map((i) => i.id);\n    atividade.data.map((categoria) => {\n      if (atividadesList.includes(categoria.id)) {\n        response.value.push(categoria.label);\n      }\n      return categoria;\n    });\n    return response.value.length > 0\n      ? { ...response, value: response.value.join(', ') }\n      : {};\n  }).filter((atividade) => atividade.label);\n\n  const createImage = async () => {\n    try {\n      const result = await ImagePicker.launchImageLibraryAsync({\n        mediaTypes: ImagePicker.MediaTypeOptions.All,\n        allowsEditing: true,\n        aspect: [3, 3],\n        quality: 1,\n        base64: true,\n      });\n      if (!result.cancelled) {\n        setLoading(true);\n        const { status, data } = await Api.post(`/v1/users/${user.id}/image`, {\n          image: result,\n        });\n        setLoading(false);\n        if (status !== 200) {\n          Alert.alert('Error', 'Something goes wrong in server');\n        }\n        setUser({ ...user, Image: { imageUrl: data.url } });\n      }\n    } catch (E) {\n      console.log(E);\n    }\n  };\n\n  useEffect(() => {\n    (async () => {\n      if (Platform.OS !== 'web') {\n        const { status } = await Permissions.askAsync(Permissions.CAMERA_ROLL);\n        if (status !== 'granted') {\n          Alert.alert(\n            'Error',\n            'Sorry, we need camera roll permissions to make this work!'\n          );\n        }\n      }\n    })();\n  }, []);\n\n  useEffect(() => {\n    const fetchApiData = async () => {\n      setLoading(true);\n      const userData = await Api.get(`v1/users/${user.id}`);\n      if (userData.status !== 200) {\n        // console.log(userData.data, userData.status, user.id);\n        Alert.alert(\n          'Erro',\n          'Houve um erro no servidor, tente novamente mais tarde'\n        );\n      } else {\n        setCurrentUser(userData.data);\n        const response = await Api.get('v1/activities');\n        if (response.status !== 200) {\n          Alert.alert(\n            'Erro',\n            'Houve um erro no servidor, tente novamente mais tarde'\n          );\n        } else {\n          setLoading(false);\n          const activities = response.data.map((activity) => {\n            const nest = activity.nest.map((subActivity) => {\n              return {\n                id: subActivity.id,\n                label: subActivity.name,\n                checked: false,\n              };\n            });\n            return {\n              id: activity.id,\n              label: activity.name,\n              open: false,\n              data: nest,\n            };\n          });\n          setAtividadesLista(activities);\n        }\n      }\n    };\n    fetchApiData();\n  }, [user]);\n\n  return (\n    <View style={styles.wrapper}>\n      <ScrollView style={{ width: '100%', marginTop: 30 }}>\n        <View style={styles.body}>\n          <TouchableWithoutFeedback onPress={() => createImage()}>\n            <Image\n              source={\n                user.Image !== null ? { uri: user.Image.imageUrl } : NoUser\n              }\n              style={styles.logoImage}\n            />\n          </TouchableWithoutFeedback>\n          <Text style={styles.userName}>\n            {currentUser.name}{' '}\n            <Text style={styles.rate}>{currentUser.rate}</Text>\n          </Text>\n          <RateStars nota={currentUser.rate} />\n          <InfoContainer\n            title=\"Informações\"\n            items={infoItems}\n            setCurrentUser={setCurrentUser}\n            onPress={() => navigation.navigate('InformacoesGerais')}\n          />\n          <InfoContainer\n            title=\"Ramo de Atividade\"\n            items={atividadesItems}\n            onPress={() => navigation.navigate('MinhasAtividades')}\n          />\n          <ComentariosContainer user={user} />\n        </View>\n      </ScrollView>\n      <Footer active=\"Meu Perfil\" />\n    </View>\n  );\n};\n\nexport default MeuPerfil;\n"]},"metadata":{},"sourceType":"module"}