{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nvar _jsxFileName = \"/home/bayons/indicom-app-master/app/components/ComentariosContainer/ComentariosContainer.jsx\";\nimport React, { useState, useEffect, useContext } from 'react';\nimport View from \"react-native-web/dist/exports/View\";\nimport Text from \"react-native-web/dist/exports/Text\";\nimport StyleSheet from \"react-native-web/dist/exports/StyleSheet\";\nimport Image from \"react-native-web/dist/exports/Image\";\nimport ActivityIndicator from \"react-native-web/dist/exports/ActivityIndicator\";\nimport Alert from \"react-native-web/dist/exports/Alert\";\nimport Api from \"../../services/Api\";\nimport AuthContext from \"../../contexts/auth\";\nimport Button from \"../Button\";\nimport RateStars from \"../RateStars\";\nimport NoUser from \"../../../assets/img/user-icon.png\";\nvar styles = StyleSheet.create({\n  container: {\n    marginTop: 10,\n    backgroundColor: '#FFF',\n    width: '95%',\n    borderRadius: 8,\n    borderWidth: 1,\n    borderColor: 'rgba(0, 0, 0, 0.25)',\n    padding: 5,\n    paddingBottom: 30\n  },\n  titleContainer: {\n    flexDirection: 'row',\n    justifyContent: 'space-between',\n    alignItems: 'center'\n  },\n  titleText: {\n    fontWeight: 'bold',\n    fontSize: 16\n  },\n  strong: {\n    fontWeight: 'bold'\n  },\n  comentariosContainer: {\n    alignItems: 'center',\n    padding: 5\n  },\n  comentario: {\n    marginTop: 20,\n    marginBottom: 20,\n    flexDirection: 'row'\n  },\n  content: {\n    flex: 1,\n    paddingLeft: 5\n  },\n  comentarioNome: {\n    fontSize: 16,\n    paddingBottom: 2,\n    fontWeight: 'bold'\n  },\n  comentarioContent: {\n    paddingTop: 5\n  },\n  userImg: {\n    width: 60,\n    height: 60,\n    borderRadius: 30\n  }\n});\n\nvar ComentariosContainer = function ComentariosContainer(_ref) {\n  var user = _ref.user,\n      renderComentarios = _ref.renderComentarios,\n      setNota = _ref.setNota,\n      setDone = _ref.setDone,\n      loggedUser = _ref.loggedUser;\n\n  var _useContext = useContext(AuthContext),\n      deslogar = _useContext.deslogar;\n\n  var _useState = useState([]),\n      _useState2 = _slicedToArray(_useState, 2),\n      fullList = _useState2[0],\n      setFullList = _useState2[1];\n\n  var _useState3 = useState([]),\n      _useState4 = _slicedToArray(_useState3, 2),\n      list = _useState4[0],\n      setList = _useState4[1];\n\n  var _useState5 = useState(3),\n      _useState6 = _slicedToArray(_useState5, 2),\n      slice = _useState6[0],\n      setSlice = _useState6[1];\n\n  var _useState7 = useState(0),\n      _useState8 = _slicedToArray(_useState7, 2),\n      ocultos = _useState8[0],\n      setOcultos = _useState8[1];\n\n  var _useState9 = useState(true),\n      _useState10 = _slicedToArray(_useState9, 2),\n      loading = _useState10[0],\n      setLoading = _useState10[1];\n\n  var _useState11 = useState(false),\n      _useState12 = _slicedToArray(_useState11, 2),\n      btnLoading = _useState12[0],\n      setBtnLoading = _useState12[1];\n\n  useEffect(function () {\n    var getComments = function getComments() {\n      var comments, commentList, ownComment, rate;\n      return _regeneratorRuntime.async(function getComments$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              _context.next = 2;\n              return _regeneratorRuntime.awrap(Api.get(\"v1/users/\" + user.id + \"/comments\"));\n\n            case 2:\n              comments = _context.sent;\n\n              if (comments.status !== 200) {\n                if (comments.status === 401) {\n                  deslogar();\n                } else {\n                  Alert.alert('Atenção', 'Houve um problema no servidor para encontrar os comentários');\n                }\n              } else {\n                commentList = comments.data.length > 3 ? comments.data.slice(0, 3) : comments.data;\n                setFullList(comments.data);\n                setList(commentList);\n                setOcultos(comments.data.length - commentList.length);\n\n                if (setNota) {\n                  ownComment = false;\n                  rate = 0;\n                  comments.data.map(function (i) {\n                    rate = parseInt(rate, 10) + parseInt(i.rate, 10);\n                    if (i.fromUser.id === loggedUser.id) ownComment = true;\n                    return i;\n                  });\n                  rate = parseFloat(parseFloat(rate / comments.data.length).toFixed(2));\n                  setNota(rate || 0);\n                  if (setDone && !ownComment) setDone(true);\n                }\n\n                setLoading(false);\n              }\n\n            case 4:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, null, null, null, Promise);\n    };\n\n    getComments();\n  }, [renderComentarios]);\n  useEffect(function () {\n    var getComments = function getComments() {\n      var comments, commentList, ownComment, rate;\n      return _regeneratorRuntime.async(function getComments$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              _context2.next = 2;\n              return _regeneratorRuntime.awrap(Api.get(\"v1/users/\" + user.id + \"/comments\"));\n\n            case 2:\n              comments = _context2.sent;\n\n              if (comments.status !== 200) {\n                if (comments.status === 401) {\n                  deslogar();\n                } else {\n                  Alert.alert('Atenção', 'Houve um problema no servidor para encontrar os comentários');\n                }\n              } else {\n                commentList = comments.data.length > 3 ? comments.data.slice(0, 3) : comments.data;\n                setFullList(comments.data);\n                setList(commentList);\n                setOcultos(comments.data.length - commentList.length);\n\n                if (setNota) {\n                  ownComment = false;\n                  rate = 0;\n                  comments.data.map(function (i) {\n                    rate = parseInt(rate, 10) + parseInt(i.rate, 10);\n                    if (i.fromUser.id === loggedUser.id) ownComment = true;\n                    return i;\n                  });\n                  rate = parseFloat(parseFloat(rate / comments.data.length).toFixed(2));\n                  setNota(rate || 0);\n                  if (setDone && !ownComment) setDone(true);\n                }\n\n                setLoading(false);\n              }\n\n            case 4:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, null, null, null, Promise);\n    };\n\n    getComments();\n  }, []);\n\n  var handleVerMais = function handleVerMais() {\n    setBtnLoading(true);\n    var newSlice = slice + 3;\n    setSlice(newSlice);\n    setOcultos(ocultos - 3);\n    var newList = fullList.slice(0, newSlice);\n    setList(newList);\n    setBtnLoading(false);\n  };\n\n  if (loading) return React.createElement(View, {\n    style: styles.container,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 176,\n      columnNumber: 7\n    }\n  }, React.createElement(View, {\n    style: styles.titleContainer,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 177,\n      columnNumber: 9\n    }\n  }, React.createElement(Text, {\n    style: styles.titleText,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 178,\n      columnNumber: 11\n    }\n  }, \"Coment\\xE1rios\")), React.createElement(View, {\n    style: styles.comentariosContainer,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 180,\n      columnNumber: 9\n    }\n  }, React.createElement(ActivityIndicator, {\n    color: \"#000\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 181,\n      columnNumber: 11\n    }\n  })));\n  console.log(list);\n  return React.createElement(View, {\n    style: styles.container,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 187,\n      columnNumber: 5\n    }\n  }, React.createElement(View, {\n    style: styles.titleContainer,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 188,\n      columnNumber: 7\n    }\n  }, React.createElement(Text, {\n    style: styles.titleText,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 189,\n      columnNumber: 9\n    }\n  }, \"Coment\\xE1rios\")), React.createElement(View, {\n    style: styles.comentariosContainer,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 191,\n      columnNumber: 7\n    }\n  }, list.length === 0 ? React.createElement(Text, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 193,\n      columnNumber: 11\n    }\n  }, \"Nenhum coment\\xE1rio.\") : list.map(function (comentario) {\n    return React.createElement(View, {\n      style: styles.comentario,\n      key: Math.random().toString(36).substring(7),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 196,\n        columnNumber: 13\n      }\n    }, React.createElement(View, {\n      style: styles.img,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 200,\n        columnNumber: 15\n      }\n    }, React.createElement(Image, {\n      source: comentario.fromUser.Image !== null ? {\n        uri: comentario.fromUser.Image.imageUrl\n      } : NoUser,\n      style: styles.userImg,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 201,\n        columnNumber: 17\n      }\n    })), React.createElement(View, {\n      style: styles.content,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 210,\n        columnNumber: 15\n      }\n    }, React.createElement(Text, {\n      style: styles.comentarioNome,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 211,\n        columnNumber: 17\n      }\n    }, comentario.fromUser.name), React.createElement(RateStars, {\n      nota: comentario.rate,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 214,\n        columnNumber: 17\n      }\n    }), React.createElement(Text, {\n      style: styles.comentarioContent,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 215,\n        columnNumber: 17\n      }\n    }, comentario.content)));\n  }), ocultos > 0 && React.createElement(Button, {\n    customStyles: {\n      backgroundColor: '#FFD500',\n      width: '70%'\n    },\n    onPress: handleVerMais,\n    textWeigth: \"bold\",\n    textColor: \"#000\",\n    loading: btnLoading,\n    loadingStyle: {\n      color: '#000'\n    },\n    label: \"VER MAIS\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 223,\n      columnNumber: 11\n    }\n  })));\n};\n\nexport default ComentariosContainer;","map":{"version":3,"sources":["/home/bayons/indicom-app-master/app/components/ComentariosContainer/ComentariosContainer.jsx"],"names":["React","useState","useEffect","useContext","Api","AuthContext","Button","RateStars","NoUser","styles","StyleSheet","create","container","marginTop","backgroundColor","width","borderRadius","borderWidth","borderColor","padding","paddingBottom","titleContainer","flexDirection","justifyContent","alignItems","titleText","fontWeight","fontSize","strong","comentariosContainer","comentario","marginBottom","content","flex","paddingLeft","comentarioNome","comentarioContent","paddingTop","userImg","height","ComentariosContainer","user","renderComentarios","setNota","setDone","loggedUser","deslogar","fullList","setFullList","list","setList","slice","setSlice","ocultos","setOcultos","loading","setLoading","btnLoading","setBtnLoading","getComments","get","id","comments","status","Alert","alert","commentList","data","length","ownComment","rate","map","i","parseInt","fromUser","parseFloat","toFixed","handleVerMais","newSlice","newList","console","log","Math","random","toString","substring","img","Image","uri","imageUrl","name","color"],"mappings":"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","sourcesContent":["import React, { useState, useEffect, useContext } from 'react';\nimport {\n  View,\n  Text,\n  StyleSheet,\n  Image,\n  ActivityIndicator,\n  Alert,\n} from 'react-native';\nimport Api from '../../services/Api';\nimport AuthContext from '../../contexts/auth';\n\nimport Button from '../Button';\nimport RateStars from '../RateStars';\n\nimport NoUser from '../../../assets/img/user-icon.png';\n\nconst styles = StyleSheet.create({\n  container: {\n    marginTop: 10,\n    backgroundColor: '#FFF',\n    width: '95%',\n    borderRadius: 8,\n    borderWidth: 1,\n    borderColor: 'rgba(0, 0, 0, 0.25)',\n    padding: 5,\n    paddingBottom: 30,\n  },\n  titleContainer: {\n    flexDirection: 'row',\n    justifyContent: 'space-between',\n    alignItems: 'center',\n  },\n  titleText: {\n    fontWeight: 'bold',\n    fontSize: 16,\n  },\n  strong: {\n    fontWeight: 'bold',\n  },\n  comentariosContainer: {\n    alignItems: 'center',\n    padding: 5,\n  },\n  comentario: {\n    marginTop: 20,\n    marginBottom: 20,\n    flexDirection: 'row',\n  },\n  content: {\n    flex: 1,\n    paddingLeft: 5,\n  },\n  comentarioNome: {\n    fontSize: 16,\n    paddingBottom: 2,\n    fontWeight: 'bold',\n  },\n  comentarioContent: {\n    paddingTop: 5,\n  },\n  userImg: {\n    width: 60,\n    height: 60,\n    borderRadius: 30,\n  },\n});\n\nconst ComentariosContainer = ({\n  user,\n  renderComentarios,\n  setNota,\n  setDone,\n  loggedUser,\n}) => {\n  const { deslogar } = useContext(AuthContext);\n  const [fullList, setFullList] = useState([]);\n  const [list, setList] = useState([]);\n  const [slice, setSlice] = useState(3);\n  const [ocultos, setOcultos] = useState(0);\n  const [loading, setLoading] = useState(true);\n  const [btnLoading, setBtnLoading] = useState(false);\n\n  useEffect(() => {\n    const getComments = async () => {\n      const comments = await Api.get(`v1/users/${user.id}/comments`);\n      if (comments.status !== 200) {\n        if (comments.status === 401) {\n          deslogar();\n        } else {\n          Alert.alert(\n            'Atenção',\n            'Houve um problema no servidor para encontrar os comentários'\n          );\n        }\n      } else {\n        const commentList =\n          comments.data.length > 3 ? comments.data.slice(0, 3) : comments.data;\n\n        setFullList(comments.data);\n        setList(commentList);\n        setOcultos(comments.data.length - commentList.length);\n\n        if (setNota) {\n          let ownComment = false;\n          let rate = 0;\n          comments.data.map((i) => {\n            rate = parseInt(rate, 10) + parseInt(i.rate, 10);\n            if (i.fromUser.id === loggedUser.id) ownComment = true;\n            return i;\n          });\n          rate = parseFloat(parseFloat(rate / comments.data.length).toFixed(2));\n          setNota(rate || 0);\n          if (setDone && !ownComment) setDone(true);\n        }\n\n        setLoading(false);\n      }\n    };\n\n    getComments();\n  }, [renderComentarios]);\n\n  useEffect(() => {\n    const getComments = async () => {\n      const comments = await Api.get(`v1/users/${user.id}/comments`);\n      if (comments.status !== 200) {\n        if (comments.status === 401) {\n          deslogar();\n        } else {\n          Alert.alert(\n            'Atenção',\n            'Houve um problema no servidor para encontrar os comentários'\n          );\n        }\n      } else {\n        const commentList =\n          comments.data.length > 3 ? comments.data.slice(0, 3) : comments.data;\n\n        setFullList(comments.data);\n        setList(commentList);\n        setOcultos(comments.data.length - commentList.length);\n\n        if (setNota) {\n          let ownComment = false;\n          let rate = 0;\n          comments.data.map((i) => {\n            rate = parseInt(rate, 10) + parseInt(i.rate, 10);\n            if (i.fromUser.id === loggedUser.id) ownComment = true;\n            return i;\n          });\n          rate = parseFloat(parseFloat(rate / comments.data.length).toFixed(2));\n          setNota(rate || 0);\n          if (setDone && !ownComment) setDone(true);\n        }\n\n        setLoading(false);\n      }\n    };\n\n    getComments();\n  }, []);\n\n  const handleVerMais = () => {\n    setBtnLoading(true);\n    const newSlice = slice + 3;\n    setSlice(newSlice);\n    setOcultos(ocultos - 3);\n    const newList = fullList.slice(0, newSlice);\n    setList(newList);\n    setBtnLoading(false);\n  };\n\n  if (loading)\n    return (\n      <View style={styles.container}>\n        <View style={styles.titleContainer}>\n          <Text style={styles.titleText}>Comentários</Text>\n        </View>\n        <View style={styles.comentariosContainer}>\n          <ActivityIndicator color=\"#000\" />\n        </View>\n      </View>\n    );\n  console.log(list);\n  return (\n    <View style={styles.container}>\n      <View style={styles.titleContainer}>\n        <Text style={styles.titleText}>Comentários</Text>\n      </View>\n      <View style={styles.comentariosContainer}>\n        {list.length === 0 ? (\n          <Text>Nenhum comentário.</Text>\n        ) : (\n          list.map((comentario) => (\n            <View\n              style={styles.comentario}\n              key={Math.random().toString(36).substring(7)}\n            >\n              <View style={styles.img}>\n                <Image\n                  source={\n                    comentario.fromUser.Image !== null\n                      ? { uri: comentario.fromUser.Image.imageUrl }\n                      : NoUser\n                  }\n                  style={styles.userImg}\n                />\n              </View>\n              <View style={styles.content}>\n                <Text style={styles.comentarioNome}>\n                  {comentario.fromUser.name}\n                </Text>\n                <RateStars nota={comentario.rate} />\n                <Text style={styles.comentarioContent}>\n                  {comentario.content}\n                </Text>\n              </View>\n            </View>\n          ))\n        )}\n        {ocultos > 0 && (\n          <Button\n            customStyles={{\n              backgroundColor: '#FFD500',\n              width: '70%',\n            }}\n            onPress={handleVerMais}\n            textWeigth=\"bold\"\n            textColor=\"#000\"\n            loading={btnLoading}\n            loadingStyle={{ color: '#000' }}\n            label=\"VER MAIS\"\n          />\n        )}\n      </View>\n    </View>\n  );\n};\n\nexport default ComentariosContainer;\n"]},"metadata":{},"sourceType":"module"}